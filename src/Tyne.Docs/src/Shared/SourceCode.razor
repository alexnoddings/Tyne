@using System.Reflection
@using Tyne.Docs.SourceGen

@if (SourceAsHtml is not null)
{
    <MudExpansionPanels Class="source-block">
        <MudExpansionPanel Text="Toggle source code">
            @((MarkupString)SourceAsHtml)
        </MudExpansionPanel>
    </MudExpansionPanels>
}

@code
{
    private Type? PreviousType { get; set; }

    [Parameter, EditorRequired]
    public Type Type { get; set; } = default!;

    private string? SourceAsHtml { get; set; }

    protected override void OnParametersSet()
    {
        if (PreviousType != Type)
        {
            PreviousType = Type;
            SourceAsHtml = SampleSource.HtmlFor(Type);
        }
    }
}
